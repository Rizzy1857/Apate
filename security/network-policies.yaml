# Network Security Policies for Project Mirage Honeypot
# ====================================================
# Comprehensive network isolation and security policies

# Kubernetes Network Policies (if using K8s)
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: honeypot-isolation
  namespace: mirage
spec:
  podSelector:
    matchLabels:
      app: mirage-honeypot
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          name: internet-facing
    ports:
    - protocol: TCP
      port: 2222  # SSH honeypot
    - protocol: TCP
      port: 8080  # HTTP honeypot
    - protocol: TCP
      port: 8081  # IoT honeypot
    - protocol: TCP
      port: 7878  # Rust protocol
  egress:
  - to:
    - namespaceSelector:
        matchLabels:
          name: monitoring
    ports:
    - protocol: TCP
      port: 9090  # Prometheus
  - to: []  # DNS
    ports:
    - protocol: UDP
      port: 53
  - to:
    - podSelector:
        matchLabels:
          app: redis
    ports:
    - protocol: TCP
      port: 6379

---
# Management Interface Isolation
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: management-interface
  namespace: mirage
spec:
  podSelector:
    matchLabels:
      component: management
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          name: admin-network
    ports:
    - protocol: TCP
      port: 8000  # API management
  egress:
  - to:
    - podSelector:
        matchLabels:
          app: mirage-honeypot
  - to:
    - namespaceSelector:
        matchLabels:
          name: monitoring

---
# Security Monitoring Network Policy
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: security-monitoring
  namespace: mirage
spec:
  podSelector:
    matchLabels:
      component: security
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - podSelector:
        matchLabels:
          app: mirage-honeypot
  - from:
    - namespaceSelector:
        matchLabels:
          name: admin-network
    ports:
    - protocol: TCP
      port: 3000  # Grafana
    - protocol: TCP
      port: 9090  # Prometheus
  egress:
  - to: []  # Allow all outbound for threat intel
    ports:
    - protocol: TCP
      port: 443
  - to: []  # DNS
    ports:
    - protocol: UDP
      port: 53
